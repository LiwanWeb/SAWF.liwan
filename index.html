<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>تلوين الـســديري</title>
<link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

  /* تنسيقات خاصة للجوال */
@media (max-width: 768px) {
  header {
    flex-direction: column;
    text-align: center;
    padding: 10px;
  }

  nav {
    margin-top: 10px;
  }

  .main-layout {
    flex-direction: column;
    align-items: center;
    padding: 20px 10px;
    gap: 20px;
  }

  .control-box {
    width: 100%;
    flex-direction: column;
    gap: 10px;
  }

  canvas {
    margin: 20px auto 0 auto;
    width: 100%;
    max-width: 350px;
    margin-right: 0;
  }

  .btn-container {
    max-width: 100%;
    flex-direction: column;
  }

  .btn-container button {
    flex: 1 1 100%;
  }
}

/* شاشات أصغر من 480px (موبايل صغير) */
@media (max-width: 480px) {
  .btn {
    width: 100%;
    height: auto;
    font-size: 16px;
    padding: 10px;
  }

  select, input[type="file"], input[type="color"] {
    width: 100%;
  }

  .custom-upload {
    width: 100%;
    text-align: center;
  }
}
 
/* شاشات الجوال الصغيرة جدًا */
@media (max-width: 430px) {
  body {
    padding: 5px;
  }

  canvas {
    width: 100% !important;
    max-width: 300px;
  }

  .control-box, .btn-container {
    width: 100% !important;
  }

  .btn-container button,
  select,
  input[type="file"],
  input[type="color"] {
    width: 100% !important;
    font-size: 14px;
  }

  header h1 {
    font-size: 18px;
  }
}

  body {
    margin: 0;
    font-family: 'El Messiri', sans-serif;
    background: radial-gradient(circle at top left, #b8a58f, #3e3b38);
    color: white;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    height: 100%;
  margin: 0;
  overflow: hidden; /* يمنع التمرير */
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 40px;
    background: rgba(0,0,0,0.3);
    backdrop-filter: blur(6px);
  }

  .logo {
    font-weight: bold;
    font-size: 20px;
  }

  nav {
    display: flex;
    align-items: center;
    gap: 20px;
  }

  nav a {
    color: white;
    text-decoration: none;
    font-size: 14px;
    transition: color 0.3s;
  }
  nav a:hover {
    color: #ff9800;
  }

  .btn {
    width: 90px; /* عرض الزر */
    height: 50px; /* ارتفاع الزر نفس العرض ليكون مربع */
    border: none;
    border-radius: 15px; /* حواف ناعمة */
    cursor: pointer;
    font-weight: bold;
    color: white;
    transition: transform 0.2s, background 0.3s;
    font-size: 18px; /* حجم النص */
}

.btn:hover {
    transform: scale(1.05);
}


  .main-layout {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 40px 20px;
    flex-wrap: wrap;
    gap: 40px;
  }

  .controls {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .control-box {
    background: #1e1e1e;
    padding: 10px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    width: 400px;
    margin-top: 170px;
    display: flex;        /* يخلي العناصر جنب بعض */
    align-items: center;  /* يوسّطهم عموديًا */
    gap: 20px;            /* مسافة بينهم */
}

.controls1 {
    display: flex;
    flex-direction: column;
    gap: 30px;
  }

  .control1-box {
    background: #1e1e1e;
    padding: 10px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    width: 400px;
    margin-top: 15px;
    margin-bottom: 25px;
    display: flex;        /* يخلي العناصر جنب بعض */
    align-items: center;  /* يوسّطهم عموديًا */
    gap: 20px;            /* مسافة بينهم */
}


  .control-box p {
    margin-bottom: 8px;
    font-weight: bold;
  }

  input[type="file"], select, input[type="color"], button {
    width: 100%;
    margin-top: 8px;
    border-radius: 8px;
  }

  input[type="file"], select {
    padding: 8px;
    border: none;
    background: #2a2a2a;
    color: #fff;
    cursor: pointer;
  }

  input[type="color"] {
    height: 40px;
    border: none;
    cursor: pointer;
  }

  button {
    padding: 10px;
    background: linear-gradient(45deg, #c47805, #9e7a40);
    color: white;
    border: none;
    font-weight: bold;
    cursor: pointer;
    font-family: inherit;
    transition: transform 0.2s, background 0.3s;
    width: 180px;  
  }

  canvas {
    max-width: 440px; /* الحجم */
    width: 80%;
    border-radius: 12px;
    background: #2a2a2a00;
    margin-top: 40px; /* ينزل تحت 20px */
    margin-right: 200px; /* يحركه لليسار */
  }

  #upload2 {
  display: none;
} #upload1 {
  display: none;
}

/* تصميم الزر المخصص */
.custom-upload {
  background-color: hsla(36, 100%, 50%, 0);
  font-family: 'El Messiri', sans-serif;

  color: white;
  padding: 8px 16px;
  border-radius: 80px;
  cursor: pointer;
  display: inline-block;
}

#color1 {
            text-align-last: center; /* للمتصفحات الحديثة */
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: #222;
            color: white;
            padding: 10px;
            border-radius: 8px;
            border: none;
            outline: none;
            font-size: 16px;
            cursor: pointer;
            width: 150px;
            text-align: center;
            font-family: 'El Messiri', sans-serif; /* الخط الجديد */
          
            /* سهم */
            background-image: url("data:image/svg+xml;utf8,<svg fill='white' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 20px;
            padding-right: 35px;
          }
          
          #color1 option {
            padding: 10px;
            font-size: 14px;
          } 


          #color2 {
            text-align-last: center; /* للمتصفحات الحديثة */
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: #222;
            color: white;
            padding: 10px;
            border-radius: 8px;
            border: none;
            outline: none;
            font-size: 16px;
            cursor: pointer;
            width: 150px;
            text-align: center;
            font-family: 'El Messiri', sans-serif; /* الخط الجديد */
          
            /* سهم */
            background-image: url("data:image/svg+xml;utf8,<svg fill='white' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 20px;
            padding-right: 35px;
          }
          
          #color2 option {
            padding: 10px;
            font-size: 14px;
          }

          :root {
    --btn-color:  #9a7a40;
    --btn-color-dark: #0f1010;
  }

  /* ترتيب الأزرار */
  .btn-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px; /* المسافة بين الأزرار */
    max-width: 400px; /* عرض الحاوية */
  }

  /* أول زرين نص العرض */
  .btn-container button {
    flex: 1 1 calc(50% - 10px);
  }

  /* الزر الثالث بعرض كامل */
  .btn-container button:nth-child(3) {
    flex: 1 1 100%;
  }

  button {
    display: inline-block;
    padding: 0.75rem 1.25rem;
    border-radius: 10rem;
    color: #fff;
    text-transform: uppercase;
    font-size: 1rem;
    letter-spacing: 0.15rem;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
    z-index: 1;
    border: none;
    cursor: pointer;
    background: none;
    font-family: inherit;
    width: 180px;
  }

  button::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--btn-color);
    border-radius: 10rem;
    z-index: -2;
  }

  button::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0%;
    height: 100%;
    background-color: var(--btn-color-dark);
    transition: all 0.3s;
    border-radius: 10rem;
    z-index: -1;
  }

  button:hover {
    color: #c47805;
  }

  button:hover::before {
    width: 100%;
  }
        
        /* تصليح ظهور الـcanvas في الهواتف */
@media (max-width: 768px) {
  html, body {
    overflow-x: hidden;   /* امنع سكرول جانبي */
    overflow-y: auto;     /* فعّل السكرول العمودي في الجوال */
  }

  /* ألغِ الإزاحة والثوابت اللي تكسر العرض في الشاشات الصغيرة */
  canvas {
    margin-right: 0 !important;
    margin-top: 16px !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  .control-box, .btn-container {
    width: 100% !important;
  }
}

</style>

</head>
<body>
  <header>
    <div class="logo">    
      <a href="#"  onclick="location.reload();" target="_self">
        <img src="logo.png" alt="لـيــوان" style="height:90px; vertical-align:middle;">
      </a>
  </div>
  
    <div class="search-box">
        
    </div>
    <nav>
      <button class="btn" onclick="history.back()">رجوع</button>
  </nav>
  
</header>

<div class="main-layout">
  <div class="">
    <h2>
    </h2>
    
      <div class="control-box">
        
    

        <label for="upload1" style="
        display: flex; 
        justify-content: center; 
        align-items: center; 
        text-align: center; 
        width: fit-content;   /* يخلي العرض قد النص */
        margin: 0 auto;       /* يوسّط الزر نفسه بالصفحة */
      "  class="custom-upload">الـديـزايـن الخارجي</label>
        <input type="file" id="upload1">
        
          
        <br>
        <p>اللون</p>
<select id="color1" value="#808080">
  <option value="#FDFDFD" style="background:#FDFDFD;">001</option>
  <option value="#FDFDFD" style="background:#FDFDFD;">002</option>
  <option value="#FDFDFD" style="background:#FDFDFD;">003</option>
  <option value="#FDFDFD" style="background:#FDFDFD;">004</option>
  <option value="#FDFDFD" style="background:#FDFDFD;">005</option>
  <option value="#FDFDFD" style="background:#fdfdfd;">006</option>
  <option value="#FDFDFD" style="background:#FDFDFD;">001</option>
  <option value="#d8dcd7" style="background:#d8dcd7;">002</option>
  <option value="#cecfc7" style="background:#cecfc7;">003</option>
  <option value="#d0d1c6" style="background:#d0d1c6;">004</option>
  <option value="#c9c8b7" style="background:#c9c8b7;">005</option>
  <option value="#cecebb" style="background:#cecebb;">006</option>
  <option value="#c2c1ac" style="background:#c2c1ac;">007</option>
  <option value="#c9c6b2" style="background:#c9c6b2;">008</option>
  <option value="#c7c3ac" style="background:#c7c3ac;">009</option>
  <option value="#c6c1a8" style="background:#c6c1a8;">010</option>
  <option value="#c3bfa7" style="background:#c3bfa7;">011</option>
  <option value="#c3c1ad" style="background:#c3c1ad;">012</option>
  <option value="#c3c1b2" style="background:#c3c1b2;">013</option>
  <option value="#b6b2a1" style="background:#b6b2a1;">014</option>
  <option value="#b4b09d" style="background:#b4b09d;">015</option>
  <option value="#b9b59f" style="background:#b9b59f;">016</option>
  <option value="#bdb491" style="background:#bdb491;">017</option>
  <option value="#b8ab84" style="background:#b8ab84;">018</option>
  <option value="#b4aa8a" style="background:#b4aa8a;">019</option>
  <option value="#a69c7c" style="background:#a69c7c;">020</option>
  <option value="#988866" style="background:#988866;">021</option>
  <option value="#766135" style="background:#766135;">022</option>
  <option value="#8a7b5d" style="background:#8a7b5d;">023</option>
  <option value="#8e7f47" style="background:#8e7f47;">024</option>
  <option value="#857b61" style="background:#857b61;">025</option>
  <option value="#746c53" style="background:#746c53;">026</option>
  <option value="#7f7a6b" style="background:#7f7a6b;">027</option>
  <option value="#797263" style="background:#797263;">028</option>
  <option value="#564c39" style="background:#564c39;">029</option>
  <option value="#51432f" style="background:#51432f;">030</option>
  <option value="#41311f" style="background:#41311f;">031</option>
  <option value="#2d2518" style="background:#2d2518;">032</option>
  <option value="#b3a494" style="background:#b3a494;">033</option>
  <option value="#d7c7b4" style="background:#d7c7b4;">034</option>
  <option value="#c9ae9e" style="background:#c9ae9e;">035</option>
  <option value="#c2a08c" style="background:#c2a08c;">036</option>
  <option value="#b59390" style="background:#b59390;">037</option>
  <option value="#884c3e" style="background:#884c3e;">038</option>
  <option value="#5d362f" style="background:#5d362f;">039</option>
  <option value="#4f211f" style="background:#4f211f;">040</option>
  <option value="#641017" style="background:#641017;">041</option>
  <option value="#681a1d" style="background:#681a1d;">042</option>
  <option value="#3d191b" style="background:#3d191b;">043</option>
  <option value="#371e24" style="background:#371e24;">044</option>
  <option value="#3c3337" style="background:#3c3337;">045</option>
  <option value="#afb8b3" style="background:#afb8b3;">046</option>
  <option value="#93a69e" style="background:#93a69e;">047</option>
  <option value="#171a18" style="background:#171a18; color:white;">048</option>
  <option value="#e3eaea" style="background:#e3eaea;">049</option>
<option value="#f3f0ec" style="background:#f3f0ec;">050</option>
<option value="#e0d9d0" style="background:#e0d9d0;">051</option>
<option value="#d6d0c7" style="background:#d6d0c7;">052</option>
<option value="#ceccc4" style="background:#ceccc4;">053</option>
<option value="#c6c1ba" style="background:#c6c1ba;">054</option>
<option value="#b7b4ae" style="background:#b7b4ae;">055</option>
<option value="#a7a39b" style="background:#a7a39b;">056</option>
<option value="#9b9890" style="background:#9b9890;">057</option>
<option value="#8c8981" style="background:#8c8981;">058</option>
<option value="#7e7a73" style="background:#7e7a73;">059</option>
<option value="#6f6b64" style="background:#6f6b64;">060</option>
<option value="#625e57" style="background:#625e57;">061</option>
<option value="#f2f2f2" style="background:#f2f2f2;">062</option>
<option value="#e6e6e6" style="background:#e6e6e6;">063</option>
<option value="#cccccc" style="background:#cccccc;">064</option>
<option value="#b3b3b3" style="background:#b3b3b3;">065</option>
<option value="#999999" style="background:#999999;">066</option>
<option value="#808080" style="background:#808080; color:white;">067</option>
<option value="#666666" style="background:#666666; color:white;">068</option>
<option value="#4d4d4d" style="background:#4d4d4d; color:white;">069</option>
<option value="#333333" style="background:#333333; color:white;">070</option>
<option value="#1a1a1a" style="background:#1a1a1a; color:white;">071</option>
<option value="#000000" style="background:#000000; color:white;">072</option>
<option value="#fff8e7" style="background:#fff8e7;">073</option>
<option value="#ffebcd" style="background:#ffebcd;">074</option>
<option value="#ffdead" style="background:#ffdead;">075</option>
<option value="#f5deb3" style="background:#f5deb3;">076</option>
<option value="#deb887" style="background:#deb887;">077</option>
<option value="#d2b48c" style="background:#d2b48c;">078</option>
<option value="#c3b091" style="background:#c3b091;">079</option>
<option value="#a0522d" style="background:#a0522d; color:white;">080</option>
<option value="#8b4513" style="background:#8b4513; color:white;">081</option>
<option value="#654321" style="background:#654321; color:white;">082</option>
<option value="#5c4033" style="background:#5c4033; color:white;">083</option>
<option value="#3e2723" style="background:#3e2723; color:white;">084</option>
<option value="#faf0e6" style="background:#faf0e6;">085</option>
<option value="#fdf5e6" style="background:#fdf5e6;">086</option>
<option value="#fffaf0" style="background:#fffaf0;">087</option>
<option value="#fffacd" style="background:#fffacd;">088</option>
<option value="#fafad2" style="background:#fafad2;">089</option>
<option value="#ffffe0" style="background:#ffffe0;">090</option>
<option value="#f0e68c" style="background:#f0e68c;">091</option>
<option value="#ffd700" style="background:#ffd700;">092</option>
<option value="#daa520" style="background:#daa520;">093</option>
<option value="#b8860b" style="background:#b8860b; color:white;">094</option>
<option value="#ffcc00" style="background:#ffcc00;">095</option>
<option value="#ffb300" style="background:#ffb300;">096</option>
<option value="#ffa500" style="background:#ffa500;">097</option>
<option value="#ff8c00" style="background:#ff8c00;">098</option>
<option value="#ff7f50" style="background:#ff7f50;">099</option>
<option value="#ff6347" style="background:#ff6347;">100</option>
<option value="#ff4500" style="background:#ff4500;">101</option>
<option value="#ff0000" style="background:#ff0000;">102</option>

  <!-- زر تبديل الألوان -->

</select>

</div><div class="control1-box">


  <label for="upload2" style="
  display: flex; 
  justify-content: center; 
  align-items: center; 
  text-align: center; 
  width: fit-content;   /* يخلي العرض قد النص */
  margin: 0 auto;       /* يوسّط الزر نفسه بالصفحة */
"  class="custom-upload">الـديـزايـن الـداخـلـي</label>  <br><br>  
  <input type="file" id="upload2">

       
      </div>


      
      <!-- زر تطبيق الألوان -->
      <div class="btn-container">
      <button onclick="applyTints()">تطبيق الألوان</button>
      <!-- زر تحميل الصورة النهائية -->
      <button id="download-btn"onclick="downloadImage()"> تحميل الصورة </button>
    </div>
  </div>
    <canvas id="canvas"></canvas>
</div>



<script>
  // تغيير لون الخلفية حسب اللون المختار
document.getElementById('color1').addEventListener('change', function() {
  this.style.backgroundColor = this.value;

  // تحديد لون الخط بناءً على اللون المختار (فاتح أو غامق)
  let c = this.value.replace('#', '');
  let r = parseInt(c.substr(0, 2), 16);
  let g = parseInt(c.substr(2, 2), 16);
  let b = parseInt(c.substr(4, 2), 16);
  let brightness = (r * 299 + g * 587 + b * 114) / 1000;
  this.style.color = (brightness > 128) ? 'black' : 'white';
});

  const downloadBtn = document.getElementById('download-btn');

  downloadBtn.addEventListener('click', () => {
    // تغيير النص واللون
    downloadBtn.textContent = "تم التنزيل ✅";
    downloadBtn.style.setProperty('--btn-color', '#0f1010');
    downloadBtn.style.setProperty('--btn-color-dark', '#0f1010');

    // بعد ثانيتين يرجع طبيعي
    setTimeout(() => {
      downloadBtn.textContent = "تحميل الصورة النهائية ";
      downloadBtn.style.setProperty('--btn-color', '#9a7a40');
      downloadBtn.style.setProperty('--btn-color-dark', '#0f1010');
    }, 2000);
  });
</script>

<script>
  let swapState = false; // حالة التبديل
  
  let canvas = document.getElementById('canvas');
  let ctx = canvas.getContext('2d');
  let img1 = null, img2 = null;
  let originalPixels1 = null, originalPixels2 = null;
  let tintedPixels1 = null, tintedPixels2 = null;
  
  // تحميل الصور بدون تلوين
  window.addEventListener('load', () => {
    let imgA = new Image();
    imgA.onload = () => {
      canvas.width = imgA.width;
      canvas.height = imgA.height;
      let tempCanvas1 = document.createElement('canvas');
      tempCanvas1.width = imgA.width;
      tempCanvas1.height = imgA.height;
      let tempCtx1 = tempCanvas1.getContext('2d');
      tempCtx1.drawImage(imgA, 0, 0);
      originalPixels1 = tempCtx1.getImageData(0, 0, imgA.width, imgA.height);
      tintedPixels1 = originalPixels1; 
      img1 = imgA;
      renderFinal(); // اعرض الأصل فقط
    };
    imgA.src = 'وو.png';
  
    let imgB = new Image();
    imgB.onload = () => {
      let tempCanvas2 = document.createElement('canvas');
      tempCanvas2.width = canvas.width;
      tempCanvas2.height = canvas.height;
      let tempCtx2 = tempCanvas2.getContext('2d');
      tempCtx2.drawImage(imgB, 0, 0, canvas.width, canvas.height);

      tempCtx2.drawImage(imgB, 0, 0, imgB.width, imgB.height);
canvas.width = Math.max(img1.width, imgB.width);
canvas.height = Math.max(img1.height, imgB.height);

      originalPixels2 = tempCtx2.getImageData(0, 0, canvas.width, canvas.height);
      tintedPixels2 = originalPixels2;
      img2 = imgB;
      renderFinal(); // اعرض الأصل فقط
    };
    imgB.src = '66.png';
  });
   // رفع صورة جديدة بدل الافتراضية
  document.getElementById('upload1').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
      let imgA = new Image();
      imgA.onload = () => {
        canvas.width = imgA.width;
        canvas.height = imgA.height;
        let tempCanvas1 = document.createElement('canvas');
        tempCanvas1.width = imgA.width;
        tempCanvas1.height = imgA.height;
        let tempCtx1 = tempCanvas1.getContext('2d');
        tempCtx1.drawImage(imgA, 0, 0);
        originalPixels1 = tempCtx1.getImageData(0, 0, imgA.width, imgA.height);
        tintedPixels1 = originalPixels1;
        img1 = imgA;
        renderFinal();
      };
      imgA.src = ev.target.result;
    };
    reader.readAsDataURL(file);
  });

  document.getElementById('upload2').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
      let imgB = new Image();
      imgB.onload = () => {
        let tempCanvas2 = document.createElement('canvas');
        tempCanvas2.width = canvas.width;
        tempCanvas2.height = canvas.height;
        let tempCtx2 = tempCanvas2.getContext('2d');
        tempCtx2.drawImage(imgB, 0, 0, canvas.width, canvas.height);
        originalPixels2 = tempCtx2.getImageData(0, 0, canvas.width, canvas.height);
        tintedPixels2 = originalPixels2;
        img2 = imgB;
        renderFinal();
      };
      imgB.src = ev.target.result;
    };
    reader.readAsDataURL(file);
  });
 
  // زر تطبيق الألوان
  function applyTints() {
    applyTint1();
    applyTint2();
  }
  
  // دوال التلوين (ما تغيرت)
  function hexToRgb(hex) {
    hex = hex.replace(/^#/, '');
    if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
    const num = parseInt(hex, 16);
    return [(num >> 16) & 255, (num >> 8) & 255, num & 255];
  }
  
  function applyTint1() {
    if (!originalPixels1) return;
    const tint = swapState
      ? hexToRgb(document.getElementById('color2').value)
      : hexToRgb(document.getElementById('color1').value);
    const out = new ImageData(new Uint8ClampedArray(originalPixels1.data), canvas.width, canvas.height);
    for (let i = 0; i < out.data.length; i += 4) {
      const r = originalPixels1.data[i];
      const g = originalPixels1.data[i + 1];
      const b = originalPixels1.data[i + 2];
      const lum = 0.299 * r + 0.587 * g + 0.114 * b;
      const scale = lum / 255;
      out.data[i] = tint[0] * scale;
      out.data[i + 1] = tint[1] * scale;
      out.data[i + 2] = tint[2] * scale;
    }
    tintedPixels1 = out;
    renderFinal();
  }
  
  function applyTint2() {
    if (!originalPixels2) return;
    const tint = swapState
      ? hexToRgb(document.getElementById('color1').value)
      : hexToRgb(document.getElementById('color2').value);
    const out = new ImageData(new Uint8ClampedArray(originalPixels2.data), canvas.width, canvas.height);
    for (let i = 0; i < out.data.length; i += 4) {
      if (originalPixels2.data[i + 3] > 0) {
        const r = originalPixels2.data[i];
        const g = originalPixels2.data[i + 1];
        const b = originalPixels2.data[i + 2];
        const lum = 0.299 * r + 0.587 * g + 0.114 * b;
        const scale = lum / 255;
        out.data[i] = tint[0] * scale;
        out.data[i + 1] = tint[1] * scale;
        out.data[i + 2] = tint[2] * scale;
      }
    }
    tintedPixels2 = out;
    renderFinal();
  }
  
  function renderFinal() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (tintedPixels1) {
      let tempCanvas1 = document.createElement('canvas');
      tempCanvas1.width = canvas.width;
      tempCanvas1.height = canvas.height;
      tempCanvas1.getContext('2d').putImageData(tintedPixels1, 0, 0);
      ctx.drawImage(tempCanvas1, 0, 0);
    }
    if (tintedPixels2) {
      let tempCanvas2 = document.createElement('canvas');
      tempCanvas2.width = canvas.width;
      tempCanvas2.height = canvas.height;
      tempCanvas2.getContext('2d').putImageData(tintedPixels2, 0, 0);
      ctx.drawImage(tempCanvas2, 0, 0);
    }
  }
  </script>
  
 
  

</body>
</html>
